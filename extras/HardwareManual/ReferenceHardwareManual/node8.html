<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with LaTeX2HTML 2008 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>4 Modules</TITLE>
<META NAME="description" CONTENT="4 Modules">
<META NAME="keywords" CONTENT="ReferenceHardwareManual">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2008">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="ReferenceHardwareManual.css">

<LINK REL="next" HREF="node21.html">
<LINK REL="previous" HREF="node7.html">
<LINK REL="up" HREF="ReferenceHardwareManual.html">
<LINK REL="next" HREF="node9.html">
</HEAD>

<BODY >
<!--Navigation Panel-->
<A NAME="tex2html138"
  HREF="node9.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="file:/usr/share/latex2html/icons/next.png"></A> 
<A NAME="tex2html134"
  HREF="ReferenceHardwareManual.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="file:/usr/share/latex2html/icons/up.png"></A> 
<A NAME="tex2html128"
  HREF="node7.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="file:/usr/share/latex2html/icons/prev.png"></A> 
<A NAME="tex2html136"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="file:/usr/share/latex2html/icons/contents.png"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html139"
  HREF="node9.html">4.1 Boot ROM</A>
<B> Up:</B> <A NAME="tex2html135"
  HREF="ReferenceHardwareManual.html">Hardware Manual</A>
<B> Previous:</B> <A NAME="tex2html129"
  HREF="node7.html">3 Bus Arbiter</A>
 &nbsp; <B>  <A NAME="tex2html137"
  HREF="node1.html">Contents</A></B> 
<BR>
<BR>
<!--End of Navigation Panel-->

<H1><A NAME="SECTION00050000000000000000">
4 Modules</A>
</H1>

<P>
Modules have a standard port interface to facilitate a (later) module generator, and to make the arbiter code look pretty.

<P>
All modules must have the following port spec:

<P>
<PRE>
module mod_mymod(rst, clk, ie, de, iaddr, daddr, drw, din, iout, dout);
        input rst;
        input clk;
        input ie,de;
        input [31:0] iaddr, daddr;
        input drw;
        input [31:0] din;
        output [31:0] iout, dout;
</PRE>

<P>
<TABLE CELLPADDING=3 BORDER="1">
<TR><TH ALIGN="LEFT"><B>port name</B></TH>
<TH ALIGN="LEFT"><B>description</B></TH>
</TR>
<TR><TD ALIGN="LEFT">rst</TD>
<TD ALIGN="LEFT">synchronous reset</TD>
</TR>
<TR><TD ALIGN="LEFT">clk</TD>
<TD ALIGN="LEFT">system clock</TD>
</TR>
<TR><TD ALIGN="LEFT">ie</TD>
<TD ALIGN="LEFT">instruction port enable</TD>
</TR>
<TR><TD ALIGN="LEFT">de</TD>
<TD ALIGN="LEFT">data port enable</TD>
</TR>
<TR><TD ALIGN="LEFT">iaddr</TD>
<TD ALIGN="LEFT">instruction port address</TD>
</TR>
<TR><TD ALIGN="LEFT">daddr</TD>
<TD ALIGN="LEFT">data port address</TD>
</TR>
<TR><TD ALIGN="LEFT">drw</TD>
<TD ALIGN="LEFT">data port read/write. 0 = read, 1 = write</TD>
</TR>
<TR><TD ALIGN="LEFT">din</TD>
<TD ALIGN="LEFT">data port data in</TD>
</TR>
<TR><TD ALIGN="LEFT">iout</TD>
<TD ALIGN="LEFT">instruction port data out</TD>
</TR>
<TR><TD ALIGN="LEFT">dout</TD>
<TD ALIGN="LEFT">data port data out</TD>
</TR>
</TABLE>

<P>
Additional ports may be added to the end of the port list shown above, should that module have its own I/O.

<P>
Modules must be negatively edge triggered. Reset is synchronous. Output on iout and dout when not enabled (via ie and de) should be HiZ. This is accomplished with:

<P>
<PRE>
	wire [31:0] idata, ddata;
	assign iout = ie ? idata : 32'hzzzzzzzz;
	assign dout = de ? ddata : 32'hzzzzzzzz;
</PRE>

<P>
Once modules are created, they can be added to the memory map by adding a line in the mm module. Addresses passed to the module are effective addresses, that is, the upper bits that designate the module are zeroed. That is, address 0xf0200050 would appear to the module as 0x00000050.

<P>
Version 2.2 will have a module autogen script, that builds modules into the memory map with a special verilog comment:

<P>
<PRE>
	/* PLP2MODULE start:0xf0200000 length:0x00000100 */
	module my_module(rst, clk, ie, de, iaddr, daddr, drw, din, iout, dout);
</PRE>

<P>
<BR><HR>
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL>
<LI><A NAME="tex2html140"
  HREF="node9.html">4.1 Boot ROM</A>
<LI><A NAME="tex2html141"
  HREF="node10.html">4.2 Memory Hierarchy</A>
<LI><A NAME="tex2html142"
  HREF="node11.html">4.3 Cache</A>
<LI><A NAME="tex2html143"
  HREF="node12.html">4.4 UART</A>
<LI><A NAME="tex2html144"
  HREF="node13.html">4.5 VGA</A>
<LI><A NAME="tex2html145"
  HREF="node14.html">4.6 PLPID</A>
<LI><A NAME="tex2html146"
  HREF="node15.html">4.7 Timer</A>
<LI><A NAME="tex2html147"
  HREF="node16.html">4.8 Programmable Interrupt Controller</A>
<LI><A NAME="tex2html148"
  HREF="node17.html">4.9 Switches</A>
<LI><A NAME="tex2html149"
  HREF="node18.html">4.10 LEDs</A>
<LI><A NAME="tex2html150"
  HREF="node19.html">4.11 GPIO</A>
<LI><A NAME="tex2html151"
  HREF="node20.html">4.12 Seven Segment Display</A>
</UL>
<!--End of Table of Child-Links-->
<HR>
<!--Navigation Panel-->
<A NAME="tex2html138"
  HREF="node9.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="file:/usr/share/latex2html/icons/next.png"></A> 
<A NAME="tex2html134"
  HREF="ReferenceHardwareManual.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="file:/usr/share/latex2html/icons/up.png"></A> 
<A NAME="tex2html128"
  HREF="node7.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="file:/usr/share/latex2html/icons/prev.png"></A> 
<A NAME="tex2html136"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="file:/usr/share/latex2html/icons/contents.png"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html139"
  HREF="node9.html">4.1 Boot ROM</A>
<B> Up:</B> <A NAME="tex2html135"
  HREF="ReferenceHardwareManual.html">Hardware Manual</A>
<B> Previous:</B> <A NAME="tex2html129"
  HREF="node7.html">3 Bus Arbiter</A>
 &nbsp; <B>  <A NAME="tex2html137"
  HREF="node1.html">Contents</A></B> 
<!--End of Navigation Panel-->
<ADDRESS>
will
2012-02-08
</ADDRESS>
</BODY>
</HTML>
